"use strict";(self.webpackChunklearning_testing_2022_frontend=self.webpackChunklearning_testing_2022_frontend||[]).push([[343],{2343:(dt,v,a)=>{a.r(v),a.d(v,{TicketsModule:()=>mt});var b=a(6977),g=a(4521),s=a(4999),k=a(3737),d=a(1777),m=a(3075),f=a(8966),p=(()=>{return(e=p||(p={})).VERY_LOW="very_low",e.LOW="low",e.NORMAL="normal",e.HIGH="high",e.VERY_HIGH="very_high",p;var e})(),l=(()=>{return(e=l||(l={})).NEW="new",e.TO_DO="to_do",e.IN_DESIGN="in_design",e.IN_PROGRESS="in_progress",e.IN_REVIEW="in_review",e.TESTING="testing",e.DONE="done",e.CANCELLED="cancelled",l;var e})(),t=a(5e3),D=a(2340),C=a(520);let _=(()=>{class e{constructor(o){this.http=o,this.apiUrl=D.N.apiUrl}getTickets(){return this.http.get(this.apiUrl+"/tickets")}getTicketById(o){return this.http.get(`${this.apiUrl}/${o}`)}createTicket(o){return this.http.post(`${this.apiUrl}/tickets`,o)}}return e.\u0275fac=function(o){return new(o||e)(t.LFG(C.eN))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var I=a(6529),A=a(2290),u=a(7322),Z=a(7531),h=a(9808),N=a(4107),y=a(508),O=a(7423);function M(e,i){if(1&e&&(t.TgZ(0,"mat-error"),t._uU(1),t.qZA()),2&e){const o=t.oxw();t.xp6(1),t.Oqu(o.getInputErrorMessage(o.form.get("title")))}}function S(e,i){if(1&e&&(t.TgZ(0,"mat-option",17),t._uU(1),t.qZA()),2&e){const o=i.$implicit;t.Q6J("value",o.value),t.xp6(1),t.hij(" ",o.viewValue," ")}}function U(e,i){if(1&e&&(t.TgZ(0,"mat-option",17),t._uU(1),t.qZA()),2&e){const o=i.$implicit;t.Q6J("value",o.value),t.xp6(1),t.hij(" ",o.viewValue," ")}}function R(e,i){if(1&e&&(t.TgZ(0,"mat-option",17),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&e){const o=i.$implicit;t.Q6J("value",o.value),t.xp6(1),t.hij(" ",t.lcZ(2,2,o.viewValue)," ")}}function E(e,i){if(1&e&&(t.TgZ(0,"mat-option",17),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&e){const o=i.$implicit;t.Q6J("value",o.value),t.xp6(1),t.hij(" ",t.lcZ(2,2,o.viewValue)," ")}}function B(e,i){if(1&e&&(t.TgZ(0,"mat-option",17),t._uU(1),t.qZA()),2&e){const o=i.$implicit;t.Q6J("value",o.value),t.xp6(1),t.hij(" ",o.viewValue," ")}}function F(e,i){if(1&e&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&e){const o=i.$implicit;t.xp6(1),t.Oqu(o.content)}}function J(e,i){if(1&e&&(t.ynx(0),t.YNc(1,F,2,1,"div",18),t.BQk()),2&e){const o=i.ngIf;t.xp6(1),t.Q6J("ngForOf",o)}}let Y=(()=>{class e{constructor(o,n,r,c,x,pt){this.data=o,this.dialogRef=n,this.formBuilder=r,this.ticketsService=c,this.formService=x,this.toastr=pt,this.priorityOptions=this.createSelectOptionsFromStringsArray([p.VERY_LOW,p.LOW,p.NORMAL,p.HIGH,p.VERY_HIGH]),this.statusOptions=this.createSelectOptionsFromStringsArray([l.NEW,l.TO_DO,l.IN_DESIGN,l.IN_PROGRESS,l.IN_REVIEW,l.TESTING,l.DONE,l.CANCELLED]),this.ticketsOptions=[],this.usersOptions=[]}ngOnInit(){this.initializeForm(),this.ticketsOptions=this.createTicketsOptions(this.data.tickets),this.usersOptions=this.createUsersOptions(this.data.users)}initializeForm(){this.form=this.formBuilder.group({title:["",[m.kI.required,m.kI.minLength(5),m.kI.maxLength(200)]],authorId:[{value:this.data.authorId,disabled:!0}],assigneeId:[-1],status:[{value:this.statusOptions[0].value,disabled:!this.data.ticket}],priority:[this.priorityOptions[2].value],description:[""],relatedTicket:[""]})}get title(){return this.form.get("title")}createSelectOptionsFromStringsArray(o){const n=[];for(const r of o)n.push({value:r,viewValue:r.replace(/_/g," ")});return n}createUsersOptions(o){return[{value:-1,viewValue:"-"},...o.map(c=>({value:c.id,viewValue:c.name}))]}createTicketsOptions(o){return o.map(n=>({value:n.id,viewValue:`LT-${n.id} ${n.title}`}))}onSubmit(){if(this.form.invalid)return;const o=this.form.getRawValue();o.assigneeId=-1===o.assigneeId?null:o.assigneeId,this.ticketsService.createTicket(o).subscribe({next:n=>{this.onClose(),this.data.tickets.push(n),this.toastr.success("A new ticket has been created","Success")},error:n=>{this.toastr.error("Something went wrong","Error")}})}onClose(){this.dialogRef.close()}getInputErrorMessage(o){return this.formService.getInputErrorMessage(o)}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(f.WI),t.Y36(f.so),t.Y36(m.qu),t.Y36(_),t.Y36(I.o),t.Y36(A._W))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-ticket-details-modal"]],decls:45,vars:9,consts:[[3,"formGroup","ngSubmit"],["appearance","fill"],["matInput","","formControlName","title"],[4,"ngIf"],[1,"d-flex"],["appearance","fill",1,"flex-grow-1","me-2"],["formControlName","authorId"],[3,"value",4,"ngFor","ngForOf"],["appearance","fill",1,"flex-grow-1"],["formControlName","assigneeId"],["formControlName","status"],["formControlName","priority"],["matInput","","formControlName","description","rows","10"],["formControlName","relatedTicket"],["mat-dialog-actions","","align","end"],["mat-raised-button","","color","primary","type","submit",1,"mr-xs",3,"disabled"],["mat-raised-button","","type","button",3,"click"],[3,"value"],[4,"ngFor","ngForOf"]],template:function(o,n){if(1&o&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return n.onSubmit()}),t.TgZ(1,"h2"),t._uU(2,"Index details modal"),t.qZA(),t.TgZ(3,"mat-form-field",1)(4,"mat-label"),t._uU(5,"Title"),t.qZA(),t._UZ(6,"input",2),t.YNc(7,M,2,1,"mat-error",3),t.qZA(),t.TgZ(8,"section",4)(9,"mat-form-field",5)(10,"mat-label"),t._uU(11,"Author"),t.qZA(),t.TgZ(12,"mat-select",6),t.YNc(13,S,2,2,"mat-option",7),t.qZA()(),t.TgZ(14,"mat-form-field",8)(15,"mat-label"),t._uU(16,"Assignee"),t.qZA(),t.TgZ(17,"mat-select",9),t.YNc(18,U,2,2,"mat-option",7),t.qZA()()(),t.TgZ(19,"section",4)(20,"mat-form-field",5)(21,"mat-label"),t._uU(22,"Status"),t.qZA(),t.TgZ(23,"mat-select",10),t.YNc(24,R,3,4,"mat-option",7),t.qZA()(),t.TgZ(25,"mat-form-field",8)(26,"mat-label"),t._uU(27,"Priority"),t.qZA(),t.TgZ(28,"mat-select",11),t.YNc(29,E,3,4,"mat-option",7),t.qZA()()(),t.TgZ(30,"mat-form-field",1)(31,"mat-label"),t._uU(32,"Description"),t.qZA(),t._UZ(33,"textarea",12),t.qZA(),t.TgZ(34,"mat-form-field",1)(35,"mat-label"),t._uU(36,"Related Ticket"),t.qZA(),t.TgZ(37,"mat-select",13),t.YNc(38,B,2,2,"mat-option",7),t.qZA()(),t.YNc(39,J,2,1,"ng-container",3),t.TgZ(40,"div",14)(41,"button",15),t._uU(42," Submit "),t.qZA(),t.TgZ(43,"button",16),t.NdJ("click",function(){return n.onClose()}),t._uU(44,"Close"),t.qZA()()()),2&o){let r;t.Q6J("formGroup",n.form),t.xp6(7),t.Q6J("ngIf",null==(r=n.form.get("title"))?null:r.invalid),t.xp6(6),t.Q6J("ngForOf",n.usersOptions),t.xp6(5),t.Q6J("ngForOf",n.usersOptions),t.xp6(6),t.Q6J("ngForOf",n.statusOptions),t.xp6(5),t.Q6J("ngForOf",n.priorityOptions),t.xp6(9),t.Q6J("ngForOf",n.ticketsOptions),t.xp6(1),t.Q6J("ngIf",null==n.data.ticket?null:n.data.ticket.comments),t.xp6(2),t.Q6J("disabled",n.form.invalid)}},directives:[m._Y,m.JL,m.sg,u.KE,u.hX,Z.Nt,m.Fj,m.JJ,m.u,h.O5,u.TO,N.gD,h.sg,y.ey,f.H8,O.lW],pipes:[h.rS],styles:["mat-form-field[_ngcontent-%COMP%]{display:block}.mat-form-field[_ngcontent-%COMP%]{margin-bottom:0rem}.mr-xs[_ngcontent-%COMP%]{margin-right:.5rem}"]}),e})();var L=a(6087);function P(e,i){if(1&e&&(t.TgZ(0,"th",16),t._uU(1),t.qZA()),2&e){const o=t.oxw().$implicit;t.xp6(1),t.hij(" ",o," ")}}function Q(e,i){if(1&e&&(t.TgZ(0,"td",17),t._uU(1),t.qZA()),2&e){const o=i.$implicit,n=t.oxw().$implicit,r=t.oxw();t.xp6(1),t.hij(" ",r.getTableCellValue(n,o[n])," ")}}function $(e,i){1&e&&(t.ynx(0,14),t.YNc(1,P,2,1,"th",15),t.YNc(2,Q,2,1,"td",8),t.BQk()),2&e&&t.s9C("matColumnDef",i.$implicit)}function z(e,i){if(1&e&&(t.TgZ(0,"td",17)(1,"div",18)(2,"div",19),t._uU(3),t.qZA(),t.TgZ(4,"div",19),t._uU(5),t.qZA(),t.TgZ(6,"div",19),t._uU(7),t.qZA()()()),2&e){const o=i.$implicit,n=t.oxw();t.uIk("colspan",n.ticketsColumns.length),t.xp6(1),t.Q6J("@detailExpand",o==n.expandedElement?"expanded":"collapsed"),t.xp6(2),t.hij("Description: ",o.description,""),t.xp6(2),t.hij("Created: ",o.createdAt,""),t.xp6(2),t.hij("Last updated: ",o.updatedAt,"")}}function j(e,i){1&e&&t._UZ(0,"tr",20)}function V(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"tr",21),t.NdJ("click",function(){const c=t.CHM(o).$implicit,x=t.oxw();return x.expandedElement=x.expandedElement===c?null:c}),t.qZA()}if(2&e){const o=i.$implicit,n=t.oxw();t.ekj("example-expanded-row",n.expandedElement===o)}}function G(e,i){1&e&&t._UZ(0,"tr",22)}function q(e,i){if(1&e&&(t.TgZ(0,"tr",23)(1,"td",24),t._uU(2),t.qZA()()),2&e){t.oxw();const o=t.MAs(8);t.xp6(2),t.hij('No data matching the filter "',o.value,'"')}}const H=function(){return["expandedDetail"]},W=function(){return[5,10,25,100]};let X=(()=>{class e{constructor(o,n,r){this.http=o,this.route=n,this.dialog=r,this.title="learning-testing-2022-frontend",this.ticketsDataSource=new s.by,this.tickets=[],this.ticketsColumns=["id","title","priority","status"],this.users=[]}ngOnInit(){this.getTickets(),this.getUsers()}getTickets(){this.route.data.subscribe(({tickets:o})=>{this.tickets=o,this.ticketsDataSource=new s.by(this.tickets)})}getUsers(){this.route.data.subscribe(({users:o,signedInUserId:n})=>{this.users=o,this.signedInUserId=n})}getTableCellValue(o,n){return"id"===o?`LT-${n}`:n}calculateTicketsPositions(){this.tickets.map((o,n)=>(o.position=n+1,o))}applyFilter(o){this.ticketsDataSource.filter=o.target.value.trim().toLowerCase()}drop(o){(0,k.bA)(this.tickets,o.previousIndex,o.currentIndex),this.calculateTicketsPositions(),this.ticketsDataSource=new s.by(this.tickets)}createNewTicket(){this.dialog.open(Y,{width:"700px",data:{tickets:this.tickets,users:this.users,authorId:this.signedInUserId},disableClose:!0}).afterClosed().subscribe(r=>{console.log(`The dialog was closed. Result: ${r}`),this.getTickets()})}updateTicket(){}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(C.eN),t.Y36(g.gz),t.Y36(f.uw))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-backlog"]],decls:19,vars:9,consts:[["mat-raised-button","",3,"click"],["appearance","standard"],["matInput","","placeholder","Searched term",3,"keyup"],["input",""],[1,"mat-elevation-z8"],["mat-table","","multiTemplateDataRows","","cdkDropList","",3,"dataSource","cdkDropListDropped"],[3,"matColumnDef",4,"ngFor","ngForOf"],["matColumnDef","expandedDetail"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","example-element-row","cdkDrag","",3,"example-expanded-row","click",4,"matRowDef","matRowDefColumns"],["mat-row","","class","example-detail-row",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["aria-label","Select page of tickets",3,"pageSizeOptions"],[3,"matColumnDef"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-cell",""],["mat-cell",""],[1,"example-element-detail"],[1,"example-element-description"],["mat-header-row",""],["mat-row","","cdkDrag","",1,"example-element-row",3,"click"],["mat-row","",1,"example-detail-row"],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(o,n){1&o&&(t.TgZ(0,"h2"),t._uU(1,"Tickets"),t.qZA(),t.TgZ(2,"button",0),t.NdJ("click",function(){return n.createNewTicket()}),t._uU(3,"Create ticket"),t.qZA(),t.TgZ(4,"mat-form-field",1)(5,"mat-label"),t._uU(6,"Filter"),t.qZA(),t.TgZ(7,"input",2,3),t.NdJ("keyup",function(c){return n.applyFilter(c)}),t.qZA()(),t.TgZ(9,"div",4)(10,"table",5),t.NdJ("cdkDropListDropped",function(c){return n.drop(c)}),t.YNc(11,$,3,1,"ng-container",6),t.ynx(12,7),t.YNc(13,z,8,5,"td",8),t.BQk(),t.YNc(14,j,1,0,"tr",9),t.YNc(15,V,1,2,"tr",10),t.YNc(16,G,1,0,"tr",11),t.YNc(17,q,3,1,"tr",12),t.qZA(),t._UZ(18,"mat-paginator",13),t.qZA()),2&o&&(t.xp6(10),t.Q6J("dataSource",n.ticketsDataSource),t.xp6(1),t.Q6J("ngForOf",n.ticketsColumns),t.xp6(3),t.Q6J("matHeaderRowDef",n.ticketsColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",n.ticketsColumns),t.xp6(1),t.Q6J("matRowDefColumns",t.DdM(7,H)),t.xp6(2),t.Q6J("pageSizeOptions",t.DdM(8,W)))},directives:[O.lW,u.KE,u.hX,Z.Nt,s.BZ,k.Wj,h.sg,s.w1,s.fO,s.ge,s.Dz,s.ev,s.as,s.XQ,s.nj,s.Gk,k.Zt,s.Ee,L.NW],styles:["table[_ngcontent-%COMP%]{width:100%}td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{width:25%}tr.example-detail-row[_ngcontent-%COMP%]{height:0}tr.example-element-row[_ngcontent-%COMP%]:not(.example-expanded-row):hover{background:whitesmoke}tr.example-element-row[_ngcontent-%COMP%]:not(.example-expanded-row):active{background:#efefef}.example-element-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom-width:0}.example-element-detail[_ngcontent-%COMP%]{overflow:hidden;display:flex;flex-direction:column}.example-element-diagram[_ngcontent-%COMP%]{min-width:80px;border:2px solid black;padding:8px;font-weight:lighter;margin:8px 0;height:104px}.example-element-symbol[_ngcontent-%COMP%]{font-weight:700;font-size:40px;line-height:normal}.example-element-description[_ngcontent-%COMP%]{padding:16px}.example-element-description-attribution[_ngcontent-%COMP%]{opacity:.5}.mat-form-field[_ngcontent-%COMP%]{font-size:14px;width:100%}.example-list[_ngcontent-%COMP%]{width:500px;max-width:100%;border:solid 1px #ccc;min-height:60px;display:block;background:white;border-radius:4px;overflow:hidden}.example-box[_ngcontent-%COMP%]{padding:20px 10px;border-bottom:solid 1px #ccc;color:#000000de;display:flex;flex-direction:row;align-items:center;justify-content:space-between;box-sizing:border-box;cursor:move;background:white;font-size:14px}.example-box.cdk-drag-disabled[_ngcontent-%COMP%]{background:#ccc;cursor:default}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.example-box[_ngcontent-%COMP%]:last-child{border:none}.example-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .example-box[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}"],data:{animation:[(0,d.X$)("detailExpand",[(0,d.SB)("collapsed",(0,d.oB)({height:"0px",minHeight:"0"})),(0,d.SB)("expanded",(0,d.oB)({height:"*"})),(0,d.eR)("expanded <=> collapsed",(0,d.jt)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}}),e})(),K=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-board"]],decls:2,vars:0,template:function(o,n){1&o&&(t.TgZ(0,"p"),t._uU(1,"board works!"),t.qZA())},styles:[""]}),e})();var w=a(7785);let tt=(()=>{class e{constructor(o){this.ticketsService=o}resolve(o,n){return this.ticketsService.getTickets()}}return e.\u0275fac=function(o){return new(o||e)(t.LFG(_))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var et=a(9086),ot=a(5698),nt=a(4004),it=a(262),at=a(2843),rt=a(2783);const lt=[{path:"",pathMatch:"full",canActivate:[w.a],component:X,resolve:{signedInUserId:(()=>{class e{constructor(o,n){this.authService=o,this.router=n}resolve(o,n){return this.authService.signedInUser$.pipe((0,ot.q)(1),(0,nt.U)(r=>{if(!r||!r.id)throw new Error("No user is signed-in");return r.id}),(0,it.K)(r=>(this.router.navigateByUrl("/signin"),(0,at._)(r))))}}return e.\u0275fac=function(o){return new(o||e)(t.LFG(rt.e),t.LFG(g.F0))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),tickets:tt,users:et.o}},{path:"board",canActivate:[w.a],component:K}];let ct=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[g.Bz.forChild(lt)],g.Bz]}),e})(),mt=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[b.m,ct]]}),e})()}}]);